@using Microsoft.AspNet.Identity

@helper AddCellTiltle()
{
    <text>
        if(i== 0 && j == 0){
            square.innerHTML = '<h1 class="left-cell-title"><span>0</span></h1><h1 class="center-cell-title" style="margin-top: -50px !important"><span>0</span></h1>'
        }
        else if (i == 0) {
        square.innerHTML = `
        <h1 class="left-cell-title">
            <span>${j}</span></h1>`;
        } else if (j == 0) {
        square.innerHTML = `
        <h1 class="center-cell-title">
            <span>${i}</span></h1>`;
        }
    </text>
}
@{
    ViewBag.Title = "BattleShip powered by D.P.O.I.";
}

<link rel="stylesheet" href="~/Content/BattleShip.css" />
<link rel="stylesheet" href="~/Content/board2.css" />

<h2>Chat</h2>
<input type="text" id="message"/>
<input type="button" id="sendmessage" value="Send"/>
<input type="hidden" id="displayname"/>

<ul id="discussion"></ul>
<div id="waiter" style="visibility: hidden;">
    <label id="status">Waiting for an opponent...</label>
    <br>
    <img src="~/Content/Images/spin.gif" alt="Wait">
</div>

<div id="actions" style="visibility: hidden;">
    <button id="btnSetShips"class="btn btn-default" onclick="setMap();">Set Ships</button>
</div>
<div class="container">



    <div id="docks" class="left">
    </div>


    <div id="gameboard" class="right">
    </div>
</div>
<!--
<div class="battlefield battlefield__self">
    <div class="battlefield-gap">
        <div class="battlefield-table-placeholder"><table class="battlefield-table"><tbody><tr class="battlefield-row"><td class="battlefield-cell battlefield-cell__empty"><div class="battlefield-cell-content" data-y="0" data-x="0"><span class="z"></span>&nbsp;<div class="marker marker__row">1</div><div class="marker marker__col">A</div></div></td><td class="battlefield-cell battlefield-cell__busy"><div class="battlefield-cell-content" data-y="0" data-x="1"><span class="z"></span>&nbsp;<div class="marker marker__col">B</div><div data-id="R5TIyJf6rnLz" data-length="1" data-position="h" class="ship-box ship-box__h ui-draggable ship-box__draggable" style="width: 2em; height: 2em; padding-right: 0px; padding-bottom: 0px; left: 0px; top: 0px; margin: -2px;"></div></div></td><td class="battlefield-cell battlefield-cell__empty"><div class="battlefield-cell-content" data-y="0" data-x="2"><span class="z"></span>&nbsp;<div class="marker marker__col">C</div></div></td><td class="battlefield-cell battlefield-cell__empty"><div class="battlefield-cell-content" data-y="0" data-x="3"><span class="z"></span>&nbsp;<div class="marker marker__col">D</div></div></td><td class="battlefield-cell battlefield-cell__empty"><div class="battlefield-cell-content" data-y="0" data-x="4"><span class="z"></span>&nbsp;<div class="marker marker__col">E</div></div></td><td class="battlefield-cell battlefield-cell__empty"><div class="battlefield-cell-content" data-y="0" data-x="5"><span class="z"></span>&nbsp;<div class="marker marker__col">F</div></div></td><td class="battlefield-cell battlefield-cell__empty"><div class="battlefield-cell-content" data-y="0" data-x="6"><span class="z"></span>&nbsp;<div class="marker marker__col">G</div></div></td><td class="battlefield-cell battlefield-cell__empty"><div class="battlefield-cell-content" data-y="0" data-x="7"><span class="z"></span>&nbsp;<div class="marker marker__col">H</div></div></td><td class="battlefield-cell battlefield-cell__empty"><div class="battlefield-cell-content" data-y="0" data-x="8"><span class="z"></span>&nbsp;<div class="marker marker__col">I</div></div></td><td class="battlefield-cell battlefield-cell__empty"><div class="battlefield-cell-content" data-y="0" data-x="9"><span class="z"></span>&nbsp;<div class="marker marker__col">J</div></div></td></tr><tr class="battlefield-row"><td class="battlefield-cell battlefield-cell__empty"><div class="battlefield-cell-content" data-y="1" data-x="0"><span class="z"></span>&nbsp;<div class="marker marker__row">2</div></div></td><td class="battlefield-cell battlefield-cell__empty"><div class="battlefield-cell-content" data-y="1" data-x="1"><span class="z"></span>&nbsp;</div></td><td class="battlefield-cell battlefield-cell__empty"><div class="battlefield-cell-content" data-y="1" data-x="2"><span class="z"></span>&nbsp;</div></td><td class="battlefield-cell battlefield-cell__empty"><div class="battlefield-cell-content" data-y="1" data-x="3"><span class="z"></span>&nbsp;</div></td><td class="battlefield-cell battlefield-cell__empty"><div class="battlefield-cell-content" data-y="1" data-x="4"><span class="z"></span>&nbsp;</div></td><td class="battlefield-cell battlefield-cell__empty"><div class="battlefield-cell-content" data-y="1" data-x="5"><span class="z"></span>&nbsp;</div></td><td class="battlefield-cell battlefield-cell__busy"><div class="battlefield-cell-content" data-y="1" data-x="6"><span class="z"></span>&nbsp;<div data-id="4bZ3NTS8Jn5M" data-length="2" data-position="v" class="ship-box ship-box__v ui-draggable ship-box__draggable" style="width: 2em; height: 4em; padding-right: 0px; padding-bottom: 1px;"></div></div></td><td class="battlefield-cell battlefield-cell__empty"><div class="battlefield-cell-content" data-y="1" data-x="7"><span class="z"></span>&nbsp;</div></td><td class="battlefield-cell battlefield-cell__empty"><div class="battlefield-cell-content" data-y="1" data-x="8"><span class="z"></span>&nbsp;</div></td><td class="battlefield-cell battlefield-cell__busy"><div class="battlefield-cell-content" data-y="1" data-x="9"><span class="z"></span>&nbsp;<div data-id="znb7M6aSyAQW" data-length="3" data-position="v" class="ship-box ship-box__v ui-draggable ship-box__draggable" style="width: 2em; height: 6em; padding-right: 0px; padding-bottom: 2px;"></div></div></td></tr><tr class="battlefield-row"><td class="battlefield-cell battlefield-cell__empty"><div class="battlefield-cell-content" data-y="2" data-x="0"><span class="z"></span>&nbsp;<div class="marker marker__row">3</div></div></td><td class="battlefield-cell battlefield-cell__empty"><div class="battlefield-cell-content" data-y="2" data-x="1"><span class="z"></span>&nbsp;</div></td><td class="battlefield-cell battlefield-cell__empty"><div class="battlefield-cell-content" data-y="2" data-x="2"><span class="z"></span>&nbsp;</div></td><td class="battlefield-cell battlefield-cell__empty"><div class="battlefield-cell-content" data-y="2" data-x="3"><span class="z"></span>&nbsp;</div></td><td class="battlefield-cell battlefield-cell__empty"><div class="battlefield-cell-content" data-y="2" data-x="4"><span class="z"></span>&nbsp;</div></td><td class="battlefield-cell battlefield-cell__empty"><div class="battlefield-cell-content" data-y="2" data-x="5"><span class="z"></span>&nbsp;</div></td><td class="battlefield-cell battlefield-cell__busy"><div class="battlefield-cell-content" data-y="2" data-x="6"><span class="z"></span>&nbsp;</div></td><td class="battlefield-cell battlefield-cell__empty"><div class="battlefield-cell-content" data-y="2" data-x="7"><span class="z"></span>&nbsp;</div></td><td class="battlefield-cell battlefield-cell__empty"><div class="battlefield-cell-content" data-y="2" data-x="8"><span class="z"></span>&nbsp;</div></td><td class="battlefield-cell battlefield-cell__busy"><div class="battlefield-cell-content" data-y="2" data-x="9"><span class="z"></span>&nbsp;</div></td></tr><tr class="battlefield-row"><td class="battlefield-cell battlefield-cell__empty"><div class="battlefield-cell-content" data-y="3" data-x="0"><span class="z"></span>&nbsp;<div class="marker marker__row">4</div></div></td><td class="battlefield-cell battlefield-cell__busy"><div class="battlefield-cell-content" data-y="3" data-x="1"><span class="z"></span>&nbsp;<div data-id="kJ8rCgO2Bn5R" data-length="2" data-position="h" class="ship-box ship-box__h ui-draggable ship-box__draggable" style="width: 4em; height: 2em; padding-right: 1px; padding-bottom: 0px;"></div></div></td><td class="battlefield-cell battlefield-cell__busy"><div class="battlefield-cell-content" data-y="3" data-x="2"><span class="z"></span>&nbsp;</div></td><td class="battlefield-cell battlefield-cell__empty"><div class="battlefield-cell-content" data-y="3" data-x="3"><span class="z"></span>&nbsp;</div></td><td class="battlefield-cell battlefield-cell__empty"><div class="battlefield-cell-content" data-y="3" data-x="4"><span class="z"></span>&nbsp;</div></td><td class="battlefield-cell battlefield-cell__empty"><div class="battlefield-cell-content" data-y="3" data-x="5"><span class="z"></span>&nbsp;</div></td><td class="battlefield-cell battlefield-cell__empty"><div class="battlefield-cell-content" data-y="3" data-x="6"><span class="z"></span>&nbsp;</div></td><td class="battlefield-cell battlefield-cell__empty"><div class="battlefield-cell-content" data-y="3" data-x="7"><span class="z"></span>&nbsp;</div></td><td class="battlefield-cell battlefield-cell__empty"><div class="battlefield-cell-content" data-y="3" data-x="8"><span class="z"></span>&nbsp;</div></td><td class="battlefield-cell battlefield-cell__busy"><div class="battlefield-cell-content" data-y="3" data-x="9"><span class="z"></span>&nbsp;</div></td></tr><tr class="battlefield-row"><td class="battlefield-cell battlefield-cell__empty"><div class="battlefield-cell-content" data-y="4" data-x="0"><span class="z"></span>&nbsp;<div class="marker marker__row">5</div></div></td><td class="battlefield-cell battlefield-cell__empty"><div class="battlefield-cell-content" data-y="4" data-x="1"><span class="z"></span>&nbsp;</div></td><td class="battlefield-cell battlefield-cell__empty"><div class="battlefield-cell-content" data-y="4" data-x="2"><span class="z"></span>&nbsp;</div></td><td class="battlefield-cell battlefield-cell__empty"><div class="battlefield-cell-content" data-y="4" data-x="3"><span class="z"></span>&nbsp;</div></td><td class="battlefield-cell battlefield-cell__busy"><div class="battlefield-cell-content" data-y="4" data-x="4"><span class="z"></span>&nbsp;<div data-id="r4X10TRqULEP" data-length="1" data-position="h" class="ship-box ship-box__h ui-draggable ship-box__draggable" style="width: 2em; height: 2em; padding-right: 0px; padding-bottom: 0px;"></div></div></td><td class="battlefield-cell battlefield-cell__empty"><div class="battlefield-cell-content" data-y="4" data-x="5"><span class="z"></span>&nbsp;</div></td><td class="battlefield-cell battlefield-cell__busy"><div class="battlefield-cell-content" data-y="4" data-x="6"><span class="z"></span>&nbsp;<div data-id="PBgPIjPgRlCe" data-length="1" data-position="h" class="ship-box ship-box__h ui-draggable ship-box__draggable" style="width: 2em; height: 2em; padding-right: 0px; padding-bottom: 0px;"></div></div></td><td class="battlefield-cell battlefield-cell__empty"><div class="battlefield-cell-content" data-y="4" data-x="7"><span class="z"></span>&nbsp;</div></td><td class="battlefield-cell battlefield-cell__empty"><div class="battlefield-cell-content" data-y="4" data-x="8"><span class="z"></span>&nbsp;</div></td><td class="battlefield-cell battlefield-cell__empty"><div class="battlefield-cell-content" data-y="4" data-x="9"><span class="z"></span>&nbsp;</div></td></tr><tr class="battlefield-row"><td class="battlefield-cell battlefield-cell__empty"><div class="battlefield-cell-content" data-y="5" data-x="0"><span class="z"></span>&nbsp;<div class="marker marker__row">6</div></div></td><td class="battlefield-cell battlefield-cell__empty"><div class="battlefield-cell-content" data-y="5" data-x="1"><span class="z"></span>&nbsp;</div></td><td class="battlefield-cell battlefield-cell__empty"><div class="battlefield-cell-content" data-y="5" data-x="2"><span class="z"></span>&nbsp;</div></td><td class="battlefield-cell battlefield-cell__empty"><div class="battlefield-cell-content" data-y="5" data-x="3"><span class="z"></span>&nbsp;</div></td><td class="battlefield-cell battlefield-cell__empty"><div class="battlefield-cell-content" data-y="5" data-x="4"><span class="z"></span>&nbsp;</div></td><td class="battlefield-cell battlefield-cell__empty"><div class="battlefield-cell-content" data-y="5" data-x="5"><span class="z"></span>&nbsp;</div></td><td class="battlefield-cell battlefield-cell__empty"><div class="battlefield-cell-content" data-y="5" data-x="6"><span class="z"></span>&nbsp;</div></td><td class="battlefield-cell battlefield-cell__empty"><div class="battlefield-cell-content" data-y="5" data-x="7"><span class="z"></span>&nbsp;</div></td><td class="battlefield-cell battlefield-cell__empty"><div class="battlefield-cell-content" data-y="5" data-x="8"><span class="z"></span>&nbsp;</div></td><td class="battlefield-cell battlefield-cell__empty"><div class="battlefield-cell-content" data-y="5" data-x="9"><span class="z"></span>&nbsp;</div></td></tr><tr class="battlefield-row"><td class="battlefield-cell battlefield-cell__empty"><div class="battlefield-cell-content" data-y="6" data-x="0"><span class="z"></span>&nbsp;<div class="marker marker__row">7</div></div></td><td class="battlefield-cell battlefield-cell__busy"><div class="battlefield-cell-content" data-y="6" data-x="1"><span class="z"></span>&nbsp;<div data-id="O1pxeABrTDFD" data-length="3" data-position="v" class="ship-box ship-box__v ui-draggable ship-box__draggable" style="width: 2em; height: 6em; padding-right: 0px; padding-bottom: 2px;"></div></div></td><td class="battlefield-cell battlefield-cell__empty"><div class="battlefield-cell-content" data-y="6" data-x="2"><span class="z"></span>&nbsp;</div></td><td class="battlefield-cell battlefield-cell__empty"><div class="battlefield-cell-content" data-y="6" data-x="3"><span class="z"></span>&nbsp;</div></td><td class="battlefield-cell battlefield-cell__empty"><div class="battlefield-cell-content" data-y="6" data-x="4"><span class="z"></span>&nbsp;</div></td><td class="battlefield-cell battlefield-cell__empty"><div class="battlefield-cell-content" data-y="6" data-x="5"><span class="z"></span>&nbsp;</div></td><td class="battlefield-cell battlefield-cell__empty"><div class="battlefield-cell-content" data-y="6" data-x="6"><span class="z"></span>&nbsp;</div></td><td class="battlefield-cell battlefield-cell__empty"><div class="battlefield-cell-content" data-y="6" data-x="7"><span class="z"></span>&nbsp;</div></td><td class="battlefield-cell battlefield-cell__busy"><div class="battlefield-cell-content" data-y="6" data-x="8"><span class="z"></span>&nbsp;<div data-id="2KMhDFdB0bIp" data-length="1" data-position="h" class="ship-box ship-box__h ui-draggable ship-box__draggable" style="width: 2em; height: 2em; padding-right: 0px; padding-bottom: 0px;"></div></div></td><td class="battlefield-cell battlefield-cell__empty"><div class="battlefield-cell-content" data-y="6" data-x="9"><span class="z"></span>&nbsp;</div></td></tr><tr class="battlefield-row"><td class="battlefield-cell battlefield-cell__empty"><div class="battlefield-cell-content" data-y="7" data-x="0"><span class="z"></span>&nbsp;<div class="marker marker__row">8</div></div></td><td class="battlefield-cell battlefield-cell__busy"><div class="battlefield-cell-content" data-y="7" data-x="1"><span class="z"></span>&nbsp;</div></td><td class="battlefield-cell battlefield-cell__empty"><div class="battlefield-cell-content" data-y="7" data-x="2"><span class="z"></span>&nbsp;</div></td><td class="battlefield-cell battlefield-cell__busy"><div class="battlefield-cell-content" data-y="7" data-x="3"><span class="z"></span>&nbsp;<div data-id="2VrkK4d1E3K2" data-length="4" data-position="h" class="ship-box ship-box__h ui-draggable ship-box__draggable" style="width: 8em; height: 2em; padding-right: 3px; padding-bottom: 0px;"></div></div></td><td class="battlefield-cell battlefield-cell__busy"><div class="battlefield-cell-content" data-y="7" data-x="4"><span class="z"></span>&nbsp;</div></td><td class="battlefield-cell battlefield-cell__busy"><div class="battlefield-cell-content" data-y="7" data-x="5"><span class="z"></span>&nbsp;</div></td><td class="battlefield-cell battlefield-cell__busy"><div class="battlefield-cell-content" data-y="7" data-x="6"><span class="z"></span>&nbsp;</div></td><td class="battlefield-cell battlefield-cell__empty"><div class="battlefield-cell-content" data-y="7" data-x="7"><span class="z"></span>&nbsp;</div></td><td class="battlefield-cell battlefield-cell__empty"><div class="battlefield-cell-content" data-y="7" data-x="8"><span class="z"></span>&nbsp;</div></td><td class="battlefield-cell battlefield-cell__empty"><div class="battlefield-cell-content" data-y="7" data-x="9"><span class="z"></span>&nbsp;</div></td></tr><tr class="battlefield-row"><td class="battlefield-cell battlefield-cell__empty"><div class="battlefield-cell-content" data-y="8" data-x="0"><span class="z"></span>&nbsp;<div class="marker marker__row">9</div></div></td><td class="battlefield-cell battlefield-cell__busy"><div class="battlefield-cell-content" data-y="8" data-x="1"><span class="z"></span>&nbsp;</div></td><td class="battlefield-cell battlefield-cell__empty"><div class="battlefield-cell-content" data-y="8" data-x="2"><span class="z"></span>&nbsp;</div></td><td class="battlefield-cell battlefield-cell__empty"><div class="battlefield-cell-content" data-y="8" data-x="3"><span class="z"></span>&nbsp;</div></td><td class="battlefield-cell battlefield-cell__empty"><div class="battlefield-cell-content" data-y="8" data-x="4"><span class="z"></span>&nbsp;</div></td><td class="battlefield-cell battlefield-cell__empty"><div class="battlefield-cell-content" data-y="8" data-x="5"><span class="z"></span>&nbsp;</div></td><td class="battlefield-cell battlefield-cell__empty"><div class="battlefield-cell-content" data-y="8" data-x="6"><span class="z"></span>&nbsp;</div></td><td class="battlefield-cell battlefield-cell__empty"><div class="battlefield-cell-content" data-y="8" data-x="7"><span class="z"></span>&nbsp;</div></td><td class="battlefield-cell battlefield-cell__busy"><div class="battlefield-cell-content" data-y="8" data-x="8"><span class="z"></span>&nbsp;<div data-id="ZKOJ5GTsU9o2" data-length="2" data-position="v" class="ship-box ship-box__v ui-draggable ship-box__draggable" style="width: 2em; height: 4em; padding-right: 0px; padding-bottom: 1px;"></div></div></td><td class="battlefield-cell battlefield-cell__empty"><div class="battlefield-cell-content" data-y="8" data-x="9"><span class="z"></span>&nbsp;</div></td></tr><tr class="battlefield-row"><td class="battlefield-cell battlefield-cell__empty"><div class="battlefield-cell-content" data-y="9" data-x="0"><span class="z"></span>&nbsp;<div class="marker marker__row">10</div></div></td><td class="battlefield-cell battlefield-cell__empty"><div class="battlefield-cell-content" data-y="9" data-x="1"><span class="z"></span>&nbsp;</div></td><td class="battlefield-cell battlefield-cell__empty"><div class="battlefield-cell-content" data-y="9" data-x="2"><span class="z"></span>&nbsp;</div></td><td class="battlefield-cell battlefield-cell__empty"><div class="battlefield-cell-content" data-y="9" data-x="3"><span class="z"></span>&nbsp;</div></td><td class="battlefield-cell battlefield-cell__empty"><div class="battlefield-cell-content" data-y="9" data-x="4"><span class="z"></span>&nbsp;</div></td><td class="battlefield-cell battlefield-cell__empty"><div class="battlefield-cell-content" data-y="9" data-x="5"><span class="z"></span>&nbsp;</div></td><td class="battlefield-cell battlefield-cell__empty"><div class="battlefield-cell-content" data-y="9" data-x="6"><span class="z"></span>&nbsp;</div></td><td class="battlefield-cell battlefield-cell__empty"><div class="battlefield-cell-content" data-y="9" data-x="7"><span class="z"></span>&nbsp;</div></td><td class="battlefield-cell battlefield-cell__busy"><div class="battlefield-cell-content" data-y="9" data-x="8"><span class="z"></span>&nbsp;</div></td><td class="battlefield-cell battlefield-cell__empty"><div class="battlefield-cell-content" data-y="9" data-x="9"><span class="z"></span>&nbsp;</div></td></tr></tbody></table></div>
        <div class="battlefield-label">Your grid</div>

        <div class="battlefield-stat none"></div>
    </div>

</div>
-->

@section scripts {
    <!--Script references. -->
    <!--The jQuery library is required and is referenced by default in _Layout.cshtml. -->
    <!--Reference the SignalR library. -->
    <script src="~/Scripts/jquery.signalR-2.2.0.min.js"></script>
    <!--Reference the autogenerated SignalR hub script. -->
    <script src="~/signalr/hubs"></script>
    <!--SignalR script to update the chat page and send messages.-->
    <script>

        var BOARD_INDEX = 10;
        var SIZE = 40;
        var game;
        var ships = [];
        var GAMEBOARD = document.getElementById('gameboard');
        var DOCKS = document.getElementById('docks');

        function Ship(lifes,name) {
            this.lifes = lifes;
            this.position = new Position();
            this.isOnXAxis = true;
            this.name = name;
            this.hasBeenSet = false;
        }

        function Position() {
            this.xPosition = 0;
            this.yPosition = 0;
        }

        function setMap() {
            if (ships.filter(s => !s.hasBeenSet)[0] == undefined) {
                $('#carrier').off();
                $('#battleship').off();
                $('#destroyer').off();
                $('#submarine').off();
                $('#patrol').off();
                $('#carrier').attr('draggable', false);
                $('#battleship').attr('draggable', false);
                $('#destroyer').attr('draggable', false);
                $('#submarine').attr('draggable', false);
                $('#patrol').attr('draggable', false);
                game.server.setMap(ships);
                $("#btnSetShips").hide();
            } else {
                $('#statusModal').text("You must set all ships...");
                $('#notificationModal').modal('show');
            }
           
        }

        function startGame() {
            buildFireBoard();
            GAMEBOARD.style.opacity = 0.5;
        }

        $(function() {

            // Reference the auto-generated proxy for the hub.
            game = $.connection.gameHub;
            game.client.wait = wait;
            game.client.createGame = createGame;
            // Create a function that the hub can call back to display messages.
            game.client.addNewMessageToPage = addNewMessageToPage;

            game.client.receiveHitResponse = receiveHitResponse;
            game.client.beginTurn = beginTurn;
            game.client.startGame = startGame;
            // Get the user name and store it to prepend to messages.
            $('#displayname').val('@User.Identity.GetUserName()');
            // Set initial focus to message input box.
            $('#message').focus();
            // Start the connection.
            $.connection.hub.start().done(function() {
                $('#sendmessage').click(function() {
                    // Call the Send method on the hub.
                    game.server.send($('#displayname').val(), $('#message').val());
                    // Clear text box and reset focus for next comment.
                    $('#message').val('').focus();
                });
                game.server.joined();
            });
            $.connection.hub.disconnected(function() {
                setTimeout(function() {
                    $.connection.hub.start();
                }, 2000);
            });
        });

// This optional function html-encodes messages for display in the page.
        function htmlEncode(value) {
            var encodedValue = $('<div />').text(value).html();
            return encodedValue;
        }
        function genCellId(j, i) {
            return '' + j + '-' + i;
        };

        function wait(status) {
            $("#waiter").css("visibility", "visible");
            if (status == null) {
                status = "Waiting for an opponent ...";
            }
            $("#status").text(status);
        };

        function createGame() {
            $("#waiter").css("visibility", "hidden");
            $("#actions").css("visibility", "visible");

            buildBoard();
            loadShips();
        };

        function addNewMessageToPage(name, message) {
            // Add the message to the page.
            $('#discussion').append('<li><strong>' + htmlEncode(name)
                + '</strong>: ' + htmlEncode(message) + '</li>');
        };

        function buildBoard() {
            for (i = 0; i < BOARD_INDEX; i++) {
                for (j = 0; j < BOARD_INDEX; j++) {

                    // create a new div HTML element for each grid square and make it the right size
                    var square = document.createElement("div");
                   @AddCellTiltle()
                    GAMEBOARD.appendChild(square);

                    // give each div element a unique id based on its row and column, like "s00"
                    square.id = genCellId(j, i);

                    // set each grid square's coordinates: multiples of the current row or column number
                    var topPosition = j * SIZE;
                    var leftPosition = i * SIZE; // use CSS absolute positioning to place each grid square on the page
                    square.style.top = topPosition + 'px';
                    square.style.left = leftPosition + 'px';
                    square.className = 'cell normal';
                    square.addEventListener('dragenter', drag_enter, false);
                    square.addEventListener('dragleave', drag_leave, false);
                    square.addEventListener('dragenter', drag_over, false);
                    square.addEventListener('drop', drop, false);
                    document.body.addEventListener('dragover', drag_over, false);
                }
            }
        };

        function buildFireBoard() {
            var newBoard = document.getElementById('docks');
            newBoard.innerHTML = "";
            for (i = 0; i < BOARD_INDEX; i++) {
                for (j = 0; j < BOARD_INDEX; j++) { // create a new div HTML element for each grid square and make it the right size
                    var square = document.createElement("div");
                    @AddCellTiltle()
                    newBoard.appendChild(square);

                    // give each div element a unique id based on its row and column, like "s00"
                    square.id = genCellId(j, i) + " f";

                    // set each grid square's coordinates: multiples of the current row or column number
                    var topPosition = j * SIZE;
                    var leftPosition = i * SIZE;

                    // use CSS absolute positioning to place each grid square on the page
                    square.style.top = topPosition + 'px';
                    square.style.left = leftPosition + 'px';
                    square.className = 'cell normal';

                    //square.addEventListener('dragenter', drag_enter, false);
                    //square.addEventListener('dragleave', drag_leave, false);
                    //square.addEventListener('dragenter', drag_over, false);
                    //square.addEventListener('drop', drop, false);

                    //document.body.addEventListener('dragover', drag_over, false);
                }
            }
        };

        function loadShips() {

            var carrier = document.createElement('div');
            carrier.id = 'carrier';
            var battleship = document.createElement('div');
            battleship.id = 'battleship';
            var destroyer = document.createElement('div');
            destroyer.id = 'destroyer';
            var submarine = document.createElement('div');
            submarine.id = 'submarine';
            var patrol = document.createElement('div');
            patrol.id = 'patrol';

            patrol.className = 'ships';
            submarine.className = 'ships';
            battleship.className = 'ships';
            destroyer.className = 'ships';
            carrier.className = 'ships';

            buildship(2, patrol, 1);
            buildship(3, submarine, 2);
            buildship(4, destroyer, 3);
            buildship(5, battleship, 4);
            buildship(6, carrier, 5);
        };
      
        function buildship(size, container, position) {

            var topPosition = position * SIZE;
            var leftPosition = SIZE;
            ships.push(new Ship(size,container.id));
            container.style.top = topPosition + 'px';
            container.style.left = leftPosition + 'px';
            container.style.width = size * SIZE + 'px';

            container.draggable = true;
            container.style.zIndex = 1;
            DOCKS.appendChild(container);
            $('#' + container.id).on('dragstart', drag_start);
            //container.addEventListener('dragstart', drag_start, false);
            

        };
     

        function rotate(event) {
            event.preventDefault();

            var ship = document.getElementById(event.target.id);
            if (validateRotation(ship)) {
                var shipInArray = ships.filter(s => s.name === event.target.id)[0];
                shipInArray.isOnXAxis = !shipInArray.isOnXAxis;
                var height = ship.style.height;
                var width = ship.style.width;

                ship.style.height = width;
                ship.style.width = height;
            }
            else {
                $('#statusModal').text("The Gameboard has it's limits; you must learn not to anger the Gameboard...");
                $('#notificationModal').modal('show');
            }
        };

        function drag_start(event) {
            var style = window.getComputedStyle(event.target, null);
            event.originalEvent.dataTransfer.setData("text/plain", event.target.id);
        };

        function drag_over(event) {
            event.preventDefault();
            return false;
        };

        function drag_enter(event) {
            event.preventDefault();
            var cell = document.getElementById(event.target.id);
            if (cell && cell.style.display != 'none')
                cell.className = 'cell hovered';
        };

        function drag_leave(event) {
            event.preventDefault();
            var cell = document.getElementById(event.target.id);
            if (cell && cell.style.display != 'none')
                cell.className = 'cell normal';
        };
       
        function drop(event) {
            var ship = document.getElementById(event.dataTransfer.getData("text/plain"));
            var cell = document.getElementById(event.target.id);

            cell.className = 'cell normal';

            if (evaluateDrop(ship, cell)) {
                var shipOnArray = ships.filter(s => s.name === ship.id)[0];

                shipOnArray.position.xPosition = cell.id.split('-')[1];
                shipOnArray.position.yPosition = cell.id.split('-')[0];

                ship.style.background = 'orange';

                var shipHeight = getIntHeight(ship);
                var shipWidth = getIntWidth(ship);

                //if (ship.style.width > ship.style.height) {
                //    var cellsRemaining = (shipWidth / SIZE) - 1;
                //    var origin = cell.id.split('-');
                //    for (i = 1; i <= cellsRemaining; i++) {
                //        let cellI = document.getElementById(origin[0] + '-' + (parseInt(origin[1]) + i));
                //    }
                //}
                //else {
                //    var cellsRemaining = (shipHeight / SIZE) - 1;
                //    var origin = cell.id.split('-');
                //    for (i = 1; i <= cellsRemaining; i++) {
                //        let cellI = document.getElementById((parseInt(origin[0]) + i) + '-' + origin[1]);
                //    }

                //}
                //ship.addEventListener('click', rotate);
                $('#' + ship.id).off('click').on('click', rotate);
                ship.style.top = 0;
                ship.style.left = 0;
                cell.appendChild(ship);

                handleShipPositioning(ship, ship.parentElement);

                shipOnArray.hasBeenSet = true;

            }
            else {
                $('#statusModal').text("The Gameboard has it's limits; you must learn not to anger the Gameboard...");
                $('#notificationModal').modal('show');
            }

            event.preventDefault();
            return false;
        };

        function getIntHeight(ship) {
            if (ship.style.height == '')
                return 40;
            return parseInt(ship.style.height.replace('px', ''));
        };

        function getIntWidth(ship) {
            if (ship.style.width == '')
                return 40;
            return parseInt(ship.style.width.replace('px', ''));
        };

        function validateDrop(ship, cell) {
            var result;

            var height = getIntHeight(ship);
            var width = getIntWidth(ship);

            var exists;
            if (height > width) {
                var size = (height / SIZE) - 1;
                var validString = cell.id.split('-')[1];
                exists = size + '-' + validString;
            }
            else {
                var size = (width / SIZE) - 1;
                var validString = cell.id.split('-')[0];
                exists = validString + '-' + size;
            }

            if (document.getElementById(exists))
                result = true;
            else result = false;

            return result;
        };

        function validateRotation(ship) {
            var result;

            var cell = ship.parentElement;

            var projectedHeight = getIntWidth(ship);
            var projectedWidth = getIntHeight(ship);

            var exists;
            if (projectedHeight > projectedWidth) {
                var size = (projectedHeight / SIZE) - 1;
                var validString = cell.id.split('-')[0];
                exists = (parseInt(validString) + size) + '-' + cell.id.split('-')[1];
            }
            else {
                var size = (projectedWidth / SIZE) - 1;
                var validString = cell.id.split('-')[1];
                exists = cell.id.split('-')[0] + '-' + (parseInt(validString) + size);
            }

            if (document.getElementById(exists))
                result = true;
            else result = false;

            return result;

        };

        function handleShipPositioning(ship, cell) {

            var size = (getIntWidth(ship) / SIZE) - 1;

            var position = cell.id.split('-');
            var exists = position[0] + '-' + (parseInt(position[1]) + size);

            if (!document.getElementById(exists)) {
                var width = ship.style.width;
                var height = ship.style.height;
                ship.style.height = width;
                ship.style.width = height;
                var shipInArray = ships.filter(s => s.name === event.target.id)[0];
                shipInArray.isOnXAxis = false;
            }

        };

        function evaluateDrop(ship, cell) {
            var position = cell.id.split('-');
            var size = (getIntWidth(ship) / SIZE) - 1;

            var analyzeXAxis = document.getElementById((parseInt(position[1]) + size) + '-' + position[0]);
            var analyzeYAxis = document.getElementById(position[1] + '-' + (parseInt(position[0]) + size));
            if ((ship.style.width > ship.style.height || ship.style.height == "") && analyzeXAxis) {
                return true;
            } else if ((ship.style.height > ship.style.width || ship.style.width == "") && analyzeYAxis) {
                return true;
            }
            //if (analyzeXAxis && analyzeYAxis)
            //    return true;
            //else
            return false;
        };



        function receiveHitResponse(coordinates, isMyHit, wasHit, hasGameEnded) {
            if (isMyHit) {  //Dibujar respuesta al tiro que hizo el jugador
                //draw();
            } else { //Dibujar tiro del enemigo
                //draw();
            }
            if (hasGameEnded) {
                if (isMyHit) {  //Gano
                    $("#statusModal").text("You win!!! Congratulations!!");
                    $('#notificationModalContent').css("background-Color", "Green");
                    $('#notificationModal').modal('show');
                } else {  //Perdio
                    $("#statusModal").text("You lost!!!");
                    $('#notificationModalContent').css("background-Color", "Red");
                    $('#notificationModal').modal('show');
                }
            } else {
                endTurn();
            }
           
           
        };

        function sendHitToServer(coordinates) {
            game.server.hit(coordinates);
        }

        function beginTurn() {
            $("#waiter").css("visibility", "hidden");
            $("#statusModal").text("Its your turn now!!");
            $('#notificationModal').modal('show');
        }

        function endTurn() {
            game.server.endTurn();
        }


    </script>
}

<div class="modal fade" id="notificationModal" tabindex="-1" role="dialog" aria-labelledby="deleteLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content" id="notificationModalContent" style="top: 100px;">
            <div class="modal-header">
                <h4 class="modal-title" id="deleteLabel">Notification</h4>
            </div>
            <div class="modal-body">


                <p id="statusModal">Its your turn now!!</p>
            </div>
           
        </div>
    </div>
</div>